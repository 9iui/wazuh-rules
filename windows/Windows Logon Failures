# Windows Logon Failures Detection

**Rule ID:** 18107  
**Category:** Windows Authentication  
**Platform:** Windows  
**MITRE ATT&CK:** T1110 â€“ Brute Force  

---

## Purpose
Detect failed Windows logon attempts recorded as **Event ID 4625**.  
Repeated failures may indicate password spraying, brute-force attacks, or credential misuse within an environment.

---

## Use Case
Password spraying and brute-force attacks are common in corporate networks, particularly in **Active Directory environments** where attackers attempt to gain access using weak or reused credentials.

This detection helps identify:
- Internal brute-force attempts  
- Password spraying  
- Early indicators of account compromise  

---

## Simulated Scenario
A user account attempts to log in across multiple machines but fails authentication several times within a short time window.

Windows generates multiple **Event ID 4625** entries, which are collected by Wazuh and analyzed for suspicious patterns.

---

## Rule Logic

```xml
<rule id="18107" level="5">
  <if_sid>18100</if_sid>
  <match>EventID 4625</match>
  <description>Windows failed login attempt detected.</description>
</rule>

- Privileged accounts
- Domain administrators
- Service accounts

====Increase severity for Administrator failures====
<rule id="18108" level="10">
  <if_sid>18107</if_sid>
  <field name="win.eventdata.TargetUserName">Administrator</field>
  <description>Failed login attempt on Administrator account.</description>
</rule>

====Raise severity on Domain Controllers====
<rule id="18109" level="12">
  <if_sid>18107</if_sid>
  <field name="agent.name">DC01</field>
  <description>Failed login attempt on Domain Controller.</description>
</rule>


Why this matters:
- Failures on workstations = normal noise
- Failures on Domain Controllers = high signal
